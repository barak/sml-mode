Description: Find match stop at end or beginning of buffer
Author: Jens Peter Secher <jps@debian.org>

Index: sml-mode-5.0/sml-oldindent.el
===================================================================
--- sml-mode-5.0.orig/sml-oldindent.el	2013-07-17 19:12:04.532436167 -0400
+++ sml-mode-5.0/sml-oldindent.el	2013-07-17 19:12:04.528436147 -0400
@@ -229,6 +229,7 @@
 	(condition-case () (forward-sexp 1) (error (forward-char 1))))
       (setq level
 	    (cond
+	     ((and (eobp) (> level 1)) (error "Unbalanced"))
 	     ((sml-looking-back-at this) (1+ level))
 	     ((sml-looking-back-at match) (1- level))
 	     (t (error "Unbalanced")))))
@@ -244,6 +245,7 @@
 	(condition-case () (backward-sexp 1) (error (backward-char 1))))
       (setq level
 	    (cond
+	     ((and (bobp) (> level 1)) (error "Unbalanced"))
 	     ((looking-at this) (1+ level))
 	     ((looking-at match) (1- level))
 	     (t (error "Unbalanced")))))
