#! /bin/sh
# postinst script for sml-mode

set -e

# Source debconf library.
. /usr/share/debconf/confmodule

#DEBHELPER#

# The prioity used when firing up sml-mode from emacsen.
PRIORITY=50

case "$1" in
    configure|abort-upgrade|abort-remove|abort-deconfigure)

	install-info --quiet --section "Emacs" "SML" \
	    /usr/share/info/sml-mode.info
        # Create the start-up file.
        SITESTARTFILE="/etc/emacs/site-start.d/${PRIORITY}sml-mode.el"
        cat > $SITESTARTFILE <<EOF
;; -*-emacs-lisp-*-
;; AUTOMATICALLY GENERATED by /var/lib/dpkg/info/sml-mode.postinst .
;; DO NOT EDIT.
(setq load-path (cons (concat "/usr/share/" (symbol-name flavor)
			      "/site-lisp/sml-mode") load-path))
EOF
	# Ask whether to install site-wide (using debconf).
	db_go
	db_get sml-mode/default
	if [ "$RET" = "true" ]; then 
	    cat >> $SITESTARTFILE <<EOF
;; Autoload sml-mode top-level functions site-wide.
(load "sml-mode-startup")
EOF
	fi
    ;;

    *)
        echo "postinst called with unknown argument \`$1'" >&2
        exit 0
    ;;
esac

exit 0


